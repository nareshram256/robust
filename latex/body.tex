\title{Title here}
\author{Authors here}
\maketitle

\begin{abstract}
Insert abstract here
\end{abstract}
\begin{IEEEkeywords}
Keywords here
\end{IEEEkeywords}

\section*{Notation}

\begin{supertabular}{p{2cm} p{6cm}}
	\multicolumn{2}{l}{\textbf{Indices}} \\
	$n$ 					& node \\
	$u$ 					& generation unit \\
	$\ell$ 					& transmission line \\
	$o$  					& operating condition \\
	$\nu$ 					& iteration in column-and-constraint generation \\
	$k$ 					& iteration in Benders decomposition \\
	\multicolumn{2}{l}{\textbf{Sets}} \\
	$\Psi^G$ 				& existing generation units \\
	$\Psi^L$ 				& existing transmission lines \\
	$\Psi^{G+}$ 			& candidate generation units \\
	$\Psi^{L+}$ 			& candidate transmission lines \\
	$\Phi^{L1/L2/L3}$ 		& 1st/2nd/3rd level decision variables \\
	$\Omega$ 				& uncertainty set \\
	$\Xi$ 					& feasibility set \\
	\multicolumn{2}{l}{\textbf{Parameters}} \\
	$W_o$ 						& the weight of operating condition $o$ \\
	$\tilde{D}_n$ 				& nominal demand at node $n$ \\
	$\hat{D}_n$  				& demand increase at node $n$ \\
	$C^x_u$ 					& investment cost of candidate unit $u$ \\
	$C^y_\ell$ 					& investment cost of candidate transmission line $\ell$ \\
	$C^g_{o,u}$ 				& generation cost of unit $u$ in condition $o$ \\
	$G^{max}_{o,u} 				& maximum generation of unit $u$ in condition $o$ \\
	$F^{max}_{o,\ell} 			& maximum flow on line $\ell$ in condition $o$ \\
	$F^{min}_{o,\ell} 			& minimum flow on line $\ell$ in condition $o$ \\
	$\Lambda^w$ 				& demand uncertainty budget \\
	$\Lambda^{min/max}$			& minimum/maximum price \\
	\multicolumn{2}{l}{\textbf{Binary variables}} \\
	$x_u$ 							& equal 1 if investment is made into candidate generation unit $u$ \\
	$y_\ell$ 						& equal 1 if investment is made into candidate transmission line $\ell$ \\
	$w_n$ 							& equal 1 if demand is increased from the nominal level at node $n$ \\
	\multicolumn{2}{l}{\textbf{Continuous variables}} \\
	$\theta$  						& auxiliary variable for column-and-constraint generation \\
	$d_n$ 							& uncertain demand at node $n$ \\
	$\lambda_{o,n}$ 				& price in condition $o$ at node $n$ \\
	$z_{o,n}, \, \tilde{\lambda}_{o,n}$ & auxiliary variables for linearizing $\lambda_{o, n} d_n$ \\
	$f_{o,\ell} 					& transmission flow in line $\ell$ in condition $o$ \\
	$g_{o,u}$  						& generation at unit $u$ in condition $o$ \\
	$\bar{\beta}_{o,u}$ 			& dual variable for maximum generation of unit $u$ in condition $o$ \\
	$\underline{\beta}_{o,u}$ 		& dual variable for minimum generation of unit $u$ in condition $o$ \\
	$\bar{\mu}_{o,\ell}$ 			& dual variable for maximum flow in line $\ell$ in condition $o$ \\
	$\underline{\mu}_{o,\ell}$ 		& dual variable for minimum flow in line $\ell$ in condition $o$ \\
	$\sigma_{o,u}$ 					& dual variable of subproblem \\
	$\bar{\rho}_{o, n}, \, \underline{\rho}_{o, n}$ & dual variable of subproblem \\
	$\bar{\omega}_{o, n}, \, \underline{\omega}_{o, n}$ & dual variable of subproblem \\
	$\delta$  						& auxiliary variable for Benders decomposition 
\end{supertabular}

\section{Mathematical formulation}
\label{section_formulation}

\subsection{Stochastic robust optimization problem}

The stochastic robust optimization problem is

\begin{align}
&\label{saro_obj} \underset{\Phi^{L1}}{\text{min}} \sum\limits_{u \in \Psi^{G+}} C^x_{u} x_{u} + \sum\limits_{\ell \in \Psi^{L+}} C^y_{\ell} y_{\ell} +  \\
&\underset{\Phi^{L2} \in \Omega}{\text{max}} \quad \underset{\Phi^{L3} \in \Xi}{\text{min}} \sum\limits_o W_o \sum\limits_{u} C^g_{o, u} g_{o, u},
\end{align}
where $\Phi^{L1} = \{ x_u \, \forall u \in  \Psi^{G+}, y_\ell \, \forall \ell \in  \Psi^{L+} \}$, $\Phi^{L2} = \{ d_n \, \forall n \}$, and $\Phi^{L3} = \{ g_{o,u} \, \forall o,u, f_{o, \ell} \, \forall o, \ell \}$. The uncertainty set $\Omega$ is given by
\begin{align}
\Omega = \{ &d_n = \tilde{D}_n + w_n \hat{D}_n & \forall n \nonumber \\
\label{uncertainty_set}&\sum\limits_n w_n \leq \Lambda^w \}.
\end{align}
Given the optimal values $x_u^* \, \forall u \in \Psi^{G+}$, $y_\ell^* \, \forall \ell \in \Psi^{L+}$, and $d_n^* \, \forall n$, the feasibility set $\Xi(g_{o, u}, f_{o, \ell})$ is
\begin{align}
\{ &\sum\limits_{u \in \Psi^G_{n}} g_{o, u} + \sum\limits_{\ell} Y_{\ell, n} f_{o, \ell} = d_{n}^* & \forall o, n\\
&0 \leq g_{o, u} \leq G_{o, u}^{max} & \forall o, u \in \Psi^G\\
&F_{o, \ell}^{min} \leq f_{o, \ell} \leq F_{o, \ell}^{max} & \forall o, \ell \in \Psi^L \\
&0 \leq g_{o, u} \leq G_{o, u}^{max} x_\ell^* & \forall o, u \in \Psi^{G+} \\
&F_{o, \ell}^{min} y_\ell^* \leq f_{o, \ell} \leq F_{o, \ell}^{max} y_\ell^* & \forall o, \ell \in \Psi^{L+}. \}
\end{align}

\subsection{Master problem}

The master problem at iteration $\nu$ is

\begin{align}
&\label{master_obj} \underset{\Phi^{L1}, \Omega^{M}, \theta}{\text{minimize}} \sum\limits_{u \in \Psi^{G+}} C^x_{u} x_{u} + \sum\limits_{\ell \in \Psi^{L+}} C^y_{\ell} y_{\ell} + \theta \\
&\text{subject to} \nonumber \\
&\theta \geq \sum\limits_o W_o \sum\limits_{u} C^g_{o,u} g_{o, u, \nu'} \quad \forall \nu' \leq \nu \\
&\sum\limits_{u \in \Psi^G_{n}} g_{o, u, \nu'} + \sum\limits_{\ell} Y_{\ell, n} f_{o, \ell, \nu'} = d_{n, \nu'}^* \quad \forall o, n, \nu' \leq \nu \\
&0 \leq g_{o, u, \nu'} \leq G_{o, u}^{max} \quad \forall o, u \in \Psi^G, \nu' \leq \nu \\
&F_{o, \ell}^{min} \leq f_{o, \ell, \nu'} \leq F_{o, \ell}^{max} \quad \forall o, \ell \in \Psi^L, \nu' \leq \nu \\
&0 \leq g_{o, u, \nu'} \leq G_{o, u}^{max} x_\ell \quad \forall o, u \in \Psi^{G+}, \nu' \leq \nu \\
&F_{o, \ell}^{min} y_\ell \leq f_{o, \ell, \nu'} \leq F_{o, \ell}^{max} y_\ell \quad \forall o, \ell \in \Psi^{L+}, \nu' \leq \nu,
\end{align}
where $\Omega^{M} = \{ g_{o,u,\nu'} \, \forall o, u, \nu' \leq \nu, \, f_{o, \ell, \nu'} \, \forall o, \ell, \nu' \leq \nu \}$ and $\Psi^G_{n}$ denotes the set of existing and candidate generation units $u$ that are located at node $n$. $d_{n, \nu'}^*, \, \forall n, \nu' \leq \nu$ are input data obtained from all the previous solutions of the subproblem.

\subsection{Subproblem}

The subproblem is
\begin{align}
\label{sub_obj} \underset{\Phi^{L2}, \Omega^{S}}{\text{maximize}} &\sum\limits_o \Bigg[ \sum\limits_n \lambda_{o, n} d_n - \nonumber \\
&\sum\limits_{u \in \Psi^G} \bar{\beta}_{o,u} G_{o,u}^{max} - \nonumber \\
&\sum\limits_{\ell \in \Psi^L} \bar{\mu}_{o,\ell} F_{o,\ell}^{max} - \underline{\mu}_{o,\ell} F_{o,\ell}^{min} - \nonumber \\
&\sum\limits_{u \in \Psi^{G+}} \bar{\beta}_{o,u} G_{o,u}^{max} x_u^* - \nonumber \\
&\sum\limits_{\ell \in \Psi^{L+}} \left( \bar{\mu}_{o,\ell} F_{o,\ell}^{max} - \underline{\mu}_{o,\ell} F_{o,\ell}^{min} \right) y_\ell^* \Bigg]
\end{align}
\begin{align}
&\text{subject to} \nonumber \\
&\lambda_{o, n(u)} - \bar{\beta}_{o,u} + \underline{\beta}_{o,u} = C^g_{o,u}  W_o \quad \forall o, u \\
&\sum\limits_n Y_{\ell, n} \lambda_{o, n} - \bar{\mu}_{o, \ell} + \underline{\mu}_{o, \ell} = 0 \quad \forall o, \ell \\
&\text{Eqs. } (\ref{uncertainty_set}),
\end{align}
where $\Omega^{S} = \{ \lambda_{o, n} \, \forall o, n, \, \bar{\beta}_{o,u} \, \forall o, u, \, \underline{\beta}_{o,u} \, \forall o, u, \, \bar{\mu}_{o,\ell} \, \forall o, \ell,$ $\underline{\mu}_{o,\ell} \, \forall o, \ell \}$ and the index $n(u)$ denotes which node $n$ the unit $u$ belongs to. $x_u^* \, \forall u \in \Psi^{G+}$ and $y_\ell^* \, \forall \ell \in \Psi^{L+}$ are input data obtained from the previous solution of the master problem.

The above subproblem formulation can be solved directly as an MIQP. Alternatively, the product of a continuous and a binary variable $\lambda_{o, n} d_n$ in the objective function (\ref{sub_obj}) can be linearized exactly with $\lambda_{o, n} d_n = z_{o, n} \hat{D}_n + \lambda_{o, n} \tilde{D}_n$. Consequently, the full subproblem becomes with the relevant dual variables in parentheses
\begin{align}
\label{sub_obj} \underset{w_n, \Omega^{S}}{\text{maximize}} &\sum\limits_o \Bigg[ \sum\limits_n z_{o, n} \hat{D}_n + \lambda_{o, n} \tilde{D}_n - \nonumber \\
&\sum\limits_{u \in \Psi^G} \bar{\beta}_{o,u} G_{o,u}^{max} - \nonumber \\
&\sum\limits_{\ell \in \Psi^L} \bar{\mu}_{o,\ell} F_{o,\ell}^{max} - \underline{\mu}_{o,\ell} F_{o,\ell}^{min} - \nonumber \\
&\sum\limits_{u \in \Psi^{G+}} \bar{\beta}_{o,u} G_{o,u}^{max} x_u^* - \nonumber \\
&\sum\limits_{\ell \in \Psi^{L+}} \left( \bar{\mu}_{o,\ell} F_{o,\ell}^{max} - \underline{\mu}_{o,\ell} F_{o,\ell}^{min} \right) y_\ell^* \Bigg]
\end{align}
\begin{align}
&\text{subject to} \nonumber \\
&\lambda_{o, n(u)} - \bar{\beta}_{o,u} + \underline{\beta}_{o,u} = C^g_{o,u} W_o \quad ( \sigma_{o, u} ) \quad \forall o, u \\
&\sum\limits_n Y_{\ell, n} \lambda_{o, n} - \bar{\mu}_{o, \ell} + \underline{\mu}_{o, \ell} = 0 \quad \forall o, \ell \\
&\sum\limits_n w_n \leq \Lambda^w \\
&z_{o,n} = \lambda_{o, n} - \tilde{\lambda}_{o, n} \quad \forall o, n \\
&\Lambda^{min} w_n \leq z_{o, n} \leq \Lambda^{max} w_n \quad (\underline{\rho}_{o, n}, \bar{\rho}_{o, n}) \quad \forall o,n \\
&\Lambda^{min} (1 - w_n) \leq \tilde{\lambda}_{o, n} \leq \Lambda^{max} (1 - w_n) \quad (\underline{\omega}_{o, n}, \bar{\omega}_{o, n}) \quad \forall o,n
\end{align}
The complicating variables in this problem are the binary variables $w_n$ that, once fixed, render a scenario-wise separable linear programming (LP) problem. Such a separable problem can be solved in parallel for each scenario. We apply Benders decomposition to alternate between solving for $w_n$ and solving the LP. The Benders master problem at iteration $k$ is solved using the dual variables of the Benders slave problem from iteration $k-1$ ($\sigma_{o, u, k-1} \, \forall o, u, k > 0$, $\, \bar{\rho}_{o, n, k-1} \, \forall o, n, k > 0$, $\, \underline{\rho}_{o, n, k-1} \, \forall o, n, k > 0$, $\, \bar{\omega}_{o, n, k-1} \, \forall o, n, k > 0$, $\, \underline{\omega}_{o, n, k-1} \, \forall o, n, k > 0$).
\begin{align}
&\label{benders_master} \underset{w_n, \delta} {\text{maximize}} \quad \delta \\
&\text{subject to} \nonumber \\
&\sum\limits_n w_n \leq \Lambda^w \\
&\delta - \sum\limits_o \Big[ \Lambda^{max} \sum\limits_n (\bar{\rho}_{o, n, k-1} - \bar{\omega}_{o, n, k-1}) w_n + \nonumber \\
&\Lambda^{min} \sum\limits_n (\underline{\rho}_{o, n, k-1} - \underline{\omega}_{o, n, k-1})  w_n + \nonumber \\
&\sum\limits_u C^g_{o,u} W_o \sigma_{o, u, k-1} + \Lambda^{max} \sum\limits_n \bar{\omega}_{o, n, k-1} - \nonumber \\
&\Lambda^{min} \sum\limits_n \underline{\omega}_{o, n, k-1} \Big] \leq 0 \quad \forall k > 0
\end{align}
The above formulation does not include possible infeasibility cuts. The Benders slave problem at iteration $k$ is solved using the optimal values of the Benders master problem at iteration $k$ ($w_{n, k} \, \forall n$).
\begin{align}
\label{sub_obj} \underset{\Omega^{S}}{\text{maximize}} &\sum\limits_o \Bigg[ \sum\limits_n z_{o, n} \hat{D}_n + \lambda_{o, n} \tilde{D}_n - \nonumber \\
&\sum\limits_{u \in \Psi^G} \bar{\beta}_{o,u} G_{o,u}^{max} - \nonumber \\
&\sum\limits_{\ell \in \Psi^L} \bar{\mu}_{o,\ell} F_{o,\ell}^{max} - \underline{\mu}_{o,\ell} F_{o,\ell}^{min} - \nonumber \\
&\sum\limits_{u \in \Psi^{G+}} \bar{\beta}_{o,u} G_{o,u}^{max} x_u^* - \nonumber \\
&\sum\limits_{\ell \in \Psi^{L+}} \left( \bar{\mu}_{o,\ell} F_{o,\ell}^{max} - \underline{\mu}_{o,\ell} F_{o,\ell}^{min} \right) y_\ell^* \Bigg]
\end{align}
\begin{align}
&\text{subject to} \nonumber \\
&\lambda_{o, n(u)} - \bar{\beta}_{o,u} + \underline{\beta}_{o,u} = C^g_{o,u} W_o \quad \forall o, u \\
&\sum\limits_n Y_{\ell, n} \lambda_{o, n} - \bar{\mu}_{o, \ell} + \underline{\mu}_{o, \ell} = 0 \quad \forall o, \ell \\
&z_{o,n} = \lambda_{o, n} - \tilde{\lambda}_{o, n} \quad \forall o, n \\
&\Lambda^{min} w_{n, k} \leq z_{o, n} \leq \Lambda^{max} w_{n, k} \quad \forall o,n \\
&\Lambda^{min} (1 - w_{n, k}) \leq \tilde{\lambda}_{o, n} \leq \Lambda^{max} (1 - w_{n, k}) \quad \forall o,n
\end{align}
The dual variables of the Benders slave problem are then used for the next iteration of the Benders master problem. The iteration stops once the objective function values of the Benders master and slave problems are close to each other.


