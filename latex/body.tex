\title{Title here}
\author{Authors here}
\maketitle

\begin{abstract}
Insert abstract here
\end{abstract}
\begin{IEEEkeywords}
Keywords here
\end{IEEEkeywords}

\section*{Notation}

\begin{supertabular}{p{1.5cm} p{6.5cm}}
	\multicolumn{2}{l}{\textbf{Indices}} \\
	$n$ 					& node \\
	$u$ 					& generation unit \\
	$\ell$ 					& transmission line \\
	$o$  					& operating condition \\
	$t$ 					& time step in the master problem \\
	$\tau$ 					& time step in the subproblem \\
	$\nu$ 					& iteration \\
	\multicolumn{2}{l}{\textbf{Sets}} \\
	$\Psi_n^G$ 				& existing generation units at node $n$ \\
	$\Psi^L$ 				& existing transmission lines \\
	$\Psi_n^{G+}$ 			& candidate generation units at node $n$ \\
	$\Psi^{L+}$ 			& candidate transmission lines \\
	$\Phi^{L1/L2/L3}$ 		& 1st/2nd/3rd level decision variables \\
	$\Omega$ 				& uncertainty set \\
	$\Xi$ 					& feasibility set \\
	\multicolumn{2}{l}{\textbf{Parameters}} \\
	$W_o$ 					& the weight of operating condition $o$ \\
	$\tilde{D}_{\tau, n}$ 	& nominal demand at node $n$ in period $\tau$ \\
	$\hat{D}_{\tau, n}$  	& demand increase at node $n$ in period $\tau$ \\
	$C^x_{t, u}$ 			& investment cost of candidate unit $u$ in period $t$ \\
	$C^y_{t, \ell}$ 		& investment cost of candidate transmission line $\ell$ in period $t$ \\
	$C^g_{\tau, u}$ 		& generation cost of unit $u$ in period $\tau$ \\
	$\Lambda^D$ 			& demand uncertainty budget \\
	$\Lambda^{min/max}$		& minimum/maximum price \\
	\multicolumn{2}{l}{\textbf{Binary variables}} \\
	$\hat{x}_{t, u}$ 	& equal 1 if investment is made into generation unit $u$ in period $t$ \\
	$\hat{y}_{t, \ell}$ & equal 1 if investment is made into transmission line $\ell$ in period $t$ \\
	$x_{t, u}$ 			& equal 1 if generation unit $u$ is operational in period $t$ \\
	$y_{t, \ell}$ 		& equal 1 if transmission line $\ell$ is operational in period $t$ \\
	$w_n$ 				& equal 1 if demand is increased from the nominal level at node $n$ \\
	\multicolumn{2}{l}{\textbf{Continuous variables}} \\
	$d_{\tau, n}$ 						& uncertain demand at node $n$ in period $\tau$ \\
	$z_{o, \tau, n}$ 					& auxiliary variables for linearizing $\lambda_{o, \tau, n} d_{\tau, n}$ \\
	$\lambda_{o, \tau, n}$ 				& price in condition $o$ at node $n$ in period $\tau$ \\
	$\tilde{\lambda}_{o, \tau, n}$  	& auxiliary variables for linearizing $\lambda_{o, \tau, n} d_{\tau, n}$ \\
	$f_{o, \tau, \ell, \nu} 			& transmission flow in line $\ell$ in condition $o$ in period $\tau$ at iteration $\nu$ \\
	$g_{o, \tau, u, \nu}$  				& generation at unit $u$ in condition $o$ in period $\tau$ at iteration $\nu$ \\
	$\bar{\beta}_{o, \tau, u}$ 			& dual variable for maximum generation of unit $u$ in condition $o$ in period $\tau$ \\
	$\underline{\beta}_{o, \tau, u}$ 	& dual variable for minimum generation of unit $u$ in condition $o$ in period $\tau$ \\
	$\bar{\mu}_{o, \tau, \ell}$ 		& dual variable for maximum flow in line $\ell$ in condition $o$ in period $\tau$ \\
	$\underline{\mu}_{o, \tau, \ell}$ 	& dual variable for minimum flow in line $\ell$ in condition $o$ in period $\tau$
\end{supertabular}

\section{Mathematical formulation}
\label{section_formulation}

\subsection{Stochastic robust optimization problem}

The stochastic robust optimization problem is

\begin{align}
&\label{saro_obj} \underset{\Phi^{L1}}{\text{min}} \sum\limits_{t} \left[ \sum\limits_{u \in \Psi^{G+}} C^x_{t, u} \hat{x}_{t, u} + \sum\limits_{\ell \in \Psi^{L+}} C^y_{t, \ell} \hat{y}_{t, \ell} \right] +  \\
&\underset{\Phi^{L2} \in \Omega}{\text{max}} \quad \underset{\Phi^{L3} \in \Xi}{\text{min}} \sum\limits_o W_o \sum\limits_{\tau} \sum\limits_{u} C^g_{\tau, u} g_{o, \tau, u} \\
&\text{subject to} \nonumber \\
&\label{master_constraint_first} x_{t, u} \leq \sum\limits_{t' = 1}^{t} \hat{x}_{t, u} 	\quad \forall t, u \in \Psi_n^{G+} \\
&\label{master_constraint_last} y_{t, \ell} \leq \sum\limits_{t' = 1}^{t} \hat{y}_{t, \ell} 	\quad \forall t, \ell \in \Psi^{L+}
\end{align}
where $\Phi^{L1} = \{ x_{t, u} \, \forall t, u \in  \Psi^{G+}, y_{t, \ell} \, \forall t, \ell \in  \Psi^{L+} \}$, $\Phi^{L2} = \{ d_{\tau, n} \, \forall \tau, n \}$, and $\Phi^{L3} = \{ g_{o, \tau, u} \, \forall o, \tau, u, f_{o, \tau, \ell} \, \forall o, \tau, \ell \}$. The uncertainty set $\Omega$ is given by
\begin{align}
\Omega = \{ &d_{\tau, n} = \tilde{D}_{\tau, n} + w_n \hat{D}_{\tau, n} & \forall \tau, n \nonumber \\
\label{uncertainty_set}&\sum\limits_n d_{\tau, n} \leq \Lambda^D & \forall \tau \}.
\end{align}

Given the optimal values $x_{t, u}^* \, \forall t, u \in \Psi^{G+}$, $y_{t, \ell}^* \, \forall t, \ell \in \Psi^{L+}$, and $d_{\tau, n}^* \, \forall \tau, n$, the feasibility set $\Xi(g_{o, \tau, u}, f_{o, \tau, \ell})$ is
\begin{align}
\{ &\sum\limits_{u \in \Psi^G_{n}} g_{o, \tau, u} + \sum\limits_{\ell} Y_{\ell, n} f_{o, \tau, \ell} = d_{\tau, n}^* & \forall o, \tau, n\\
&0 \leq g_{o, \tau, u} \leq G_{o, \tau, u}^{max} & \forall o, \tau, u \in \Psi_n^G\\
&F_{o, \tau, \ell}^{min} \leq f_{o, \tau, \ell} \leq F_{o, \tau, \ell}^{max} & \forall o, \tau, \ell \in \Psi^L \\
&0 \leq g_{o, \tau, u} \leq G_{o, \tau, u}^{max} x_{t(\tau), u}^* & \forall o, \tau, u \in \Psi_n^{G+} \\
&F_{o, \tau, \ell}^{min} y_{t(\tau), \ell}^* \leq f_{o, \tau, \ell} \leq F_{o, \tau, \ell}^{max} y_{t(\tau), \ell}^* & \forall o, \tau, \ell \in \Psi^{L+} \},
\end{align}
where the notation $t(\tau)$ indicates to which master problem time step $t$ the subproblem time step $\tau$ is assigned to.

\subsection{Master problem}

At iteration $\nu$, we have $\Omega_{o, \tau, \nu}^{M} = \{ g_{o, \tau, u, \nu'} \, \forall o, \tau, u, \nu' \leq \nu, f_{o, \tau, \ell, \nu'} \, \forall o, \tau, \ell, \nu' \leq \nu \}$. Given $d_{\tau, n, \nu'}^*, \, \forall \tau, n, \nu' \leq \nu$ as input data obtained from all the previous solutions of the subproblem, the master problem at iteration $\nu$ is

\begin{align}
&\label{master_obj} \underset{\Phi^{L1}, \Omega_{o, \tau, \nu}^{M}, \theta}{\text{minimize}} \sum\limits_{t} \left[ \sum\limits_{u \in \Psi^{G+}} C^x_{t, u} \hat{x}_{t, u} + \sum\limits_{\ell \in \Psi^{L+}} C^y_{t, \ell} \hat{y}_{t, \ell} \right] + \theta \\
&\text{subject to} \nonumber \\
&\text{Eqs. } (\ref{master_constraint_first}) - (\ref{master_constraint_last}) \\
&\theta \geq \sum\limits_o W_o \sum\limits_{\tau} \sum\limits_{u} C_{\tau, u}^g g_{o, \tau, u, \nu'} \quad \forall \nu' \leq \nu \\
&\sum\limits_{u \in \Psi^G_{n}} g_{o, \tau, u, \nu'} + \sum\limits_{\ell} Y_{\ell, n} f_{o, \tau, \ell, \nu'} = d_{\tau, n, \nu'}^* \quad \forall o, \tau, n, \nu' \leq \nu \\
&0 \leq g_{o, \tau, u, \nu'} \leq G_{o, \tau, u}^{max} \quad \forall o, \tau, u \in \Psi_n^G, \nu' \leq \nu \\
&F_{o, \tau, \ell}^{min} \leq f_{o, \tau, \ell, \nu'} \leq F_{o, \tau, \ell}^{max} \quad \forall o, \tau, \ell \in \Psi^L, \nu' \leq \nu \\
&0 \leq g_{o, \tau, u, \nu'} \leq G_{o, \tau, u}^{max} x_{t(\tau), u} \quad \forall o, \tau, u \in \Psi_n^{G+}, \nu' \leq \nu \\
&F_{o, \tau, \ell}^{min} y_{t(\tau), \ell} \leq f_{o, \tau, \ell, \nu'} \leq F_{o, \tau, \ell}^{max} y_{t(\tau), \ell} \quad \forall o, \tau, \ell \in \Psi^{L+}, \nu' \leq \nu
\end{align}

\subsection{Subproblem}

For the subproblem, we set $\Omega^{S}_{o, \tau} = \{ \lambda_{o, \tau, n} \quad \forall o, \tau, n, $ $\bar{\beta}_{o, \tau, u} \, \forall o, \tau, u, \underline{\beta}_{o, \tau, u} \,\, \forall o, \tau, u, \,\, \bar{\mu}_{o, \tau, \ell} \,\, \forall o, \tau, \ell, \,\, \underline{\mu}_{o, \tau, \ell} \,\, \forall o, \tau, \ell \}$. With $x_{t, u}^* \, \forall t, u \in \Psi^{G+}$ and $y_{t, \ell}^* \, \forall t, \ell \in \Psi^{L+}$ as input data obtained from the previous solution of the master problem, the subproblem is
\begin{align}
\label{sub_obj} \underset{\Phi^{L2}, \Omega_{o, \tau}^{S}}{\text{maximize}} &\sum\limits_o \sum\limits_{\tau} \Bigg[ \sum\limits_n \lambda_{o, \tau, n} d_{\tau, n} - \nonumber \\
&\sum\limits_{u \in \Psi^G} \bar{\beta}_{o, \tau, u} G_{o, \tau, u}^{max} - \nonumber \\
&\sum\limits_{\ell \in \Psi^L} \bar{\mu}_{o, \tau, \ell} F_{o, \tau, \ell}^{max} - \underline{\mu}_{o, \tau, \ell} F_{o, \tau, \ell}^{min} - \nonumber \\
&\sum\limits_{u \in \Psi^{G+}} \bar{\beta}_{o, \tau, u} G_{o, \tau, u}^{max} x_{t(\tau), u}^* - \nonumber \\
&\sum\limits_{\ell \in \Psi^{L+}} \left( \bar{\mu}_{o, \tau, \ell} F_{o, \tau, \ell}^{max} - \underline{\mu}_{o, \tau, \ell} F_{o, \tau, \ell}^{min} \right) y_{t(\tau), \ell}^* \Bigg]
\end{align}
\begin{align}
&\text{subject to} \nonumber \\
&\lambda_{o, \tau, n(u)} - \bar{\beta}_{o, \tau, u} + \underline{\beta}_{o, \tau, u} = C^g_{\tau, u}  W_o \quad \forall o, \tau, u \\
&\sum\limits_n Y_{\ell, n} \lambda_{o, \tau, n} - \bar{\mu}_{o, \tau, \ell} + \underline{\mu}_{o, \tau, \ell} = 0 \quad \forall o, \tau, \ell \\
&\text{Eqs. } (\ref{uncertainty_set}),
\end{align}
where the notation $n(u)$ indicates the node $n$ at which unit $u$ is located.

The subproblem can be solved directly as a MIQP. Alternatively, the subproblem can be re-formulated as an MILP by linearizing the product of a continuous and a binary variable $\lambda_{o, \tau, n} d_{\tau, n}$ in the objective function (\ref{sub_obj}) exactly with $\lambda_{o, \tau, n} d_{\tau, n} = z_{o, \tau, n} \hat{D}_{\tau, n} + \lambda_{o, \tau, n} \tilde{D}_{\tau, n}$ and by adding the following constraints to the subproblem
\begin{align}
&z_{o, \tau, n} = \lambda_{o, \tau, n} - \tilde{\lambda}_{o, \tau, n} \quad \forall o, \tau, n \\
&\Lambda^{min} w_n \leq z_{o, \tau, n} \leq \Lambda^{max} w_n \\
&\Lambda^{min} (1 - w_n) \leq \tilde{\lambda}_{o, \tau, n} \leq \Lambda^{max} (1 - w_n)
\end{align}

Consequently, the decision variables $d_{\tau, n} \, \forall \tau, n$ are replaced with $\{ z_{o, \tau, n} \forall o, \tau, n, \tilde{\lambda}_{o, \tau, n} \forall o, \tau, n \}$ in the subproblem.
